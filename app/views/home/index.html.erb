<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SpaceFit - ì§€ì—­ ë¶„ì„ ì„œë¹„ìŠ¤</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ </text></svg>">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: #f5f7fa;
      color: #2c3e50;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px 0;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    h1 {
      text-align: center;
      font-size: 2.5em;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .subtitle {
      text-align: center;
      font-size: 1.1em;
      opacity: 0.9;
    }

    .search-box {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 2px 20px rgba(0,0,0,0.08);
      margin-bottom: 30px;
    }

    .input-group {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }

    input[type="text"] {
      flex: 1;
      padding: 15px 20px;
      font-size: 16px;
      border: 2px solid #e0e6ed;
      border-radius: 10px;
      outline: none;
      transition: border-color 0.3s;
    }

    input[type="text"]:focus {
      border-color: #667eea;
    }

    button {
      padding: 15px 40px;
      font-size: 16px;
      font-weight: 600;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    button:active {
      transform: translateY(0);
    }

    .content-grid {
      display: grid;
      grid-template-columns: 1fr 350px;
      gap: 20px;
      margin-bottom: 20px;
    }

    .map-container {
      background: white;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 2px 20px rgba(0,0,0,0.08);
    }

    #map {
      width: 100%;
      height: 600px;
    }

    .results-panel {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 2px 20px rgba(0,0,0,0.08);
      max-height: 600px;
      overflow-y: auto;
    }

    .report-section {
      margin-top: 40px;
      margin-bottom: 40px;
      width: 100%;
    }

    .report-container {
      background: white;
      border-radius: 15px;
      padding: 40px;
      box-shadow: 0 4px 25px rgba(0,0,0,0.1);
      max-width: 1200px;
      margin: 0 auto;
    }

    .report-section-divider {
      margin: 30px 0;
      padding: 15px 0;
      border-top: 2px dashed #e0e6ed;
    }

    .score-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 25px;
      border-radius: 12px;
      text-align: center;
      margin-bottom: 25px;
    }

    .score-value {
      font-size: 3em;
      font-weight: 700;
      margin: 10px 0;
    }

    .score-label {
      font-size: 1.1em;
      opacity: 0.9;
    }

    .category-item {
      padding: 15px;
      margin-bottom: 12px;
      background: #f8f9fa;
      border-radius: 10px;
      border-left: 4px solid #667eea;
    }

    .category-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .category-name {
      font-weight: 600;
      font-size: 1.05em;
    }

    .category-count {
      background: #667eea;
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.9em;
      font-weight: 600;
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: #667eea;
      font-size: 1.1em;
    }

    .error {
      background: #fee;
      color: #c33;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
    }

    .marker-legend {
      background: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 2px 20px rgba(0,0,0,0.08);
    }

    .legend-title {
      font-weight: 600;
      margin-bottom: 15px;
      font-size: 1.1em;
    }

    .legend-item {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }

    .legend-color {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .facility-info {
      margin-top: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 10px;
      border-left: 4px solid #667eea;
    }

    .facility-info-title {
      font-weight: 600;
      margin-bottom: 10px;
      color: #2c3e50;
      font-size: 1.05em;
    }

    .facility-info-detail {
      font-size: 0.9em;
      color: #666;
      margin-bottom: 5px;
    }

    .facilities-list {
      margin-top: 25px;
    }

    .facilities-category {
      margin-bottom: 20px;
    }

    .facilities-category-header {
      font-weight: 600;
      margin-bottom: 10px;
      color: #2c3e50;
      font-size: 1.05em;
      padding-bottom: 8px;
      border-bottom: 2px solid #e0e6ed;
    }

    .facility-item {
      padding: 10px;
      margin-bottom: 8px;
      background: white;
      border-radius: 8px;
      border-left: 3px solid #667eea;
      font-size: 0.9em;
      cursor: pointer;
      transition: background 0.2s, transform 0.1s;
    }

    .facility-item:hover {
      background: #f8f9fa;
      transform: translateX(2px);
    }

    .facility-item-name {
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 3px;
    }

    .facility-item-address {
      color: #666;
      font-size: 0.85em;
      margin-bottom: 3px;
    }

    .facility-item-distance {
      color: #667eea;
      font-size: 0.85em;
      font-weight: 500;
    }

    @media (max-width: 1024px) {
      .content-grid {
        grid-template-columns: 1fr;
      }

      #map {
        height: 400px;
      }

      .results-panel {
        max-height: none;
      }

      .report-container {
        padding: 25px;
      }
    }

    @media (max-width: 768px) {
      .report-container {
        padding: 20px;
      }

      h2 {
        font-size: 1.5em !important;
      }

      h3 {
        font-size: 1.2em !important;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>ğŸ  SpaceFit</h1>
      <p class="subtitle">ì£¼ì†Œë¥¼ ì…ë ¥í•˜ë©´ ì£¼ë³€ í¸ì˜ì‹œì„¤ì„ ë¶„ì„í•´ë“œë¦½ë‹ˆë‹¤</p>
    </div>
  </header>

  <div class="container">
    <div class="search-box">
      <div class="input-group">
        <input type="text" id="address" placeholder="ì˜ˆ: ì„œìš¸ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123" />
        <button onclick="searchAddress()">ë¶„ì„í•˜ê¸°</button>
      </div>
      <div id="error-message"></div>
    </div>

    <div class="content-grid">
      <div class="map-container">
        <div id="map"></div>
      </div>

      <div class="results-panel" id="results-summary">
        <p style="text-align: center; color: #999; padding: 100px 20px;">
          ì£¼ì†Œë¥¼ ì…ë ¥í•˜ê³  ë¶„ì„í•˜ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”
        </p>
      </div>
    </div>

    <!-- ìƒì„¸ ë³´ê³ ì„œ ì„¹ì…˜ (í•˜ë‹¨ ë°°ì¹˜) -->
    <div class="report-section" id="report-section" style="display: none;">
      <div class="report-container" id="detailed-report"></div>
    </div>

    <div class="marker-legend">
      <div class="legend-title">ğŸ“ ë§ˆì»¤ ë²”ë¡€</div>
      <div class="legend-item">
        <div class="legend-color" style="background: #e74c3c;"></div>
        <span>ê²€ìƒ‰ ìœ„ì¹˜</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: #3498db;"></div>
        <span>ë³‘ì› (HP8)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: #2ecc71;"></div>
        <span>í•™êµ (SC4)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: #f39c12;"></div>
        <span>í¸ì˜ì  (CS2)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: #9b59b6;"></div>
        <span>ì§€í•˜ì² ì—­ (SW8)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: #e67e22;"></div>
        <span>ì¹´í˜ (CE7)</span>
      </div>
    </div>
  </div>

  <script>
    let map;
    let markers = [];
    let geocoder;
    let infowindow;
    let searchCircle;

    // ë§ˆì»¤ ìƒ‰ìƒ ì •ì˜
    const categoryColors = {
      'HP8': '#3498db',  // ë³‘ì› - íŒŒë‘
      'SC4': '#2ecc71',  // í•™êµ - ì´ˆë¡
      'CS2': '#f39c12',  // í¸ì˜ì  - ë…¸ë‘
      'SW8': '#9b59b6',  // ì§€í•˜ì² ì—­ - ë³´ë¼
      'CE7': '#e67e22'   // ì¹´í˜ - ì£¼í™©
    };

    const categoryNames = {
      'HP8': 'ë³‘ì›',
      'SC4': 'í•™êµ',
      'CS2': 'í¸ì˜ì ',
      'SW8': 'ì§€í•˜ì² ì—­',
      'CE7': 'ì¹´í˜'
    };

    // ì£¼ì†Œ ê²€ìƒ‰ ë° ë¶„ì„
    async function searchAddress() {
      const address = document.getElementById('address').value.trim();
      const errorDiv = document.getElementById('error-message');
      const resultsDiv = document.getElementById('results-summary');

      errorDiv.innerHTML = '';

      if (!address) {
        errorDiv.innerHTML = '<div class="error">ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>';
        return;
      }

      resultsDiv.innerHTML = '<div class="loading">ğŸ” ë¶„ì„ ì¤‘...</div>';
      clearMarkers();

      try {
        const response = await fetch(`/api/analyze?address=${encodeURIComponent(address)}`);
        const data = await response.json();

        if (!response.ok) {
          throw new Error(data.error || 'ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        }

        displayResults(data);
        displayOnMap(data);
        displayDetailedReport(data);
      } catch (error) {
        errorDiv.innerHTML = `<div class="error">âŒ ${error.message}</div>`;
        document.getElementById('results-summary').innerHTML = '<p style="text-align: center; color: #999;">ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
        document.getElementById('report-section').style.display = 'none';
      }
    }

    // ìš”ì•½ ê²°ê³¼ í‘œì‹œ (ì˜¤ë¥¸ìª½ íŒ¨ë„)
    function displayResults(data) {
      const resultsDiv = document.getElementById('results-summary');

      const totalScore = data.analysis?.total_score || 0;
      const grade = data.analysis?.grade || '-';

      let html = `
        <div class="score-card">
          <div class="score-label">ì¢…í•© ì ìˆ˜</div>
          <div class="score-value">${totalScore}ì </div>
          <div class="score-label" style="font-size: 1.5em; margin-top: 10px;">${grade} ë“±ê¸‰</div>
          <div class="score-label">${data.analysis?.recommend || 'ë¶„ì„ ì™„ë£Œ'}</div>
        </div>

        <h3 style="margin-bottom: 15px; color: #2c3e50;">ğŸ“Š ì¹´í…Œê³ ë¦¬ë³„ ì ìˆ˜</h3>
        <div style="margin-bottom: 20px;">
          <div class="category-item">
            <div class="category-header">
              <span class="category-name">ğŸ  ìƒí™œí¸ì˜ (ì˜ë£ŒÂ·êµìœ¡Â·í¸ì˜ì )</span>
              <span class="category-count">${(data.analysis?.living || 0).toFixed(1)}ì </span>
            </div>
          </div>
          <div class="category-item">
            <div class="category-header">
              <span class="category-name">ğŸš‡ êµí†µì ‘ê·¼ì„± (ì§€í•˜ì² ì—­)</span>
              <span class="category-count">${(data.analysis?.transportation || 0).toFixed(1)}ì </span>
            </div>
          </div>
          <div class="category-item">
            <div class="category-header">
              <span class="category-name">â˜• ì—¬ê°€ë¬¸í™” (ì¹´í˜)</span>
              <span class="category-count">${(data.analysis?.leisure || 0).toFixed(1)}ì </span>
            </div>
          </div>
        </div>

        <h3 style="margin-bottom: 15px; color: #2c3e50;">ğŸ“ ì£¼ë³€ ì‹œì„¤ ê°œìˆ˜</h3>
      `;

      if (data.details?.counts) {
        const counts = data.details.counts;
        const categoryMapping = {
          medical: 'ë³‘ì›',
          schools: 'í•™êµ',
          convenience_stores: 'í¸ì˜ì ',
          subway_stations: 'ì§€í•˜ì² ì—­',
          cafes: 'ì¹´í˜'
        };

        Object.entries(categoryMapping).forEach(([key, name]) => {
          const count = counts[key] || 0;
          html += `
            <div class="category-item">
              <div class="category-header">
                <span class="category-name">${name}</span>
                <span class="category-count">${count}ê°œ</span>
              </div>
            </div>
          `;
        });
      }

      html += `
        <div style="margin-top: 20px; padding: 15px; background: #f0f4ff; border-radius: 8px; font-size: 0.9em; color: #555;">
          <strong>ğŸ“ ìœ„ì¹˜:</strong> ${data.address || 'ì •ë³´ ì—†ìŒ'}<br>
          <strong>ğŸ—ºï¸ ì¢Œí‘œ:</strong> ${data.coordinates?.lat?.toFixed(4)}, ${data.coordinates?.lng?.toFixed(4)}
        </div>
      `;

      // ìƒìœ„ ì§€í‘œ í‘œì‹œ (ì‹ ê·œ)
      if (data.area_indicators) {
        html += buildAreaIndicators(data.area_indicators);
      }

      // ê³µê³µì‹œì„¤ ì¶”ì²œ ìš”ì•½ (ìƒìœ„ 3ê°œë§Œ)
      if (data.recommended_public_facilities) {
        html += buildPublicFacilityRecommendationsSummary(data.recommended_public_facilities);
      }

      resultsDiv.innerHTML = html;
    }

    // ìƒì„¸ ë³´ê³ ì„œ í‘œì‹œ (í•˜ë‹¨ ì„¹ì…˜)
    function displayDetailedReport(data) {
      const reportSection = document.getElementById('report-section');
      const reportContainer = document.getElementById('detailed-report');

      if (!data.facility_report) {
        reportSection.style.display = 'none';
        return;
      }

      reportSection.style.display = 'block';
      reportContainer.innerHTML = buildDetailedReport(data.facility_report, data.poi_list);

      // ë³´ê³ ì„œ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤ (ë¶€ë“œëŸ½ê²Œ)
      setTimeout(() => {
        reportSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }, 100);
    }

    // ìƒìœ„ ì§€í‘œ í‘œì‹œ (ì‹ ê·œ)
    function buildAreaIndicators(indicators) {
      const indicatorLabels = {
        commercial_vitality: 'ğŸª ìƒê¶Œ í™œë ¥ë„',
        residential_demand: 'ğŸ  ì£¼ê±° ìˆ˜ìš”',
        transportation: 'ğŸš‡ êµí†µ ì ‘ê·¼ì„±',
        culture_public: 'ğŸ­ ë¬¸í™”/ê³µê³µì‹œì„¤'
      };

      let html = '<div style="margin-top: 25px;"><h3 style="margin-bottom: 15px; color: #2c3e50;">ğŸ“ˆ ì§€ì—­ íŠ¹ì„± ë¶„ì„</h3>';

      Object.entries(indicators).forEach(([key, score]) => {
        const label = indicatorLabels[key] || key;
        const scoreColor = score >= 70 ? '#2ecc71' : score >= 50 ? '#f39c12' : '#e74c3c';
        const scoreLabel = score >= 70 ? 'ìš°ìˆ˜' : score >= 50 ? 'ì–‘í˜¸' : 'ë³´í†µ';

        html += `
          <div class="category-item" style="border-left-color: ${scoreColor};">
            <div class="category-header">
              <span class="category-name">${label}</span>
              <span class="category-count" style="background: ${scoreColor};">${score}ì  (${scoreLabel})</span>
            </div>
          </div>
        `;
      });

      html += '</div>';
      return html;
    }

    // ê³µê³µì‹œì„¤ ì¶”ì²œ ìš”ì•½ (ìƒìœ„ 3ê°œë§Œ, ì˜¤ë¥¸ìª½ íŒ¨ë„ìš©)
    function buildPublicFacilityRecommendationsSummary(recommendations) {
      if (!recommendations || recommendations.length === 0) {
        return '';
      }

      let html = '<div style="margin-top: 25px;"><h3 style="margin-bottom: 15px; color: #2c3e50;">ğŸ—ï¸ ì¶”ì²œ ê³µê³µì‹œì„¤ TOP 3</h3>';

      const top3 = recommendations.slice(0, 3);

      top3.forEach((rec, index) => {
        const rankColor = index === 0 ? '#FFD700' : index === 1 ? '#C0C0C0' : '#CD7F32';
        const rankEmoji = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : 'ğŸ¥‰';

        html += `
          <div class="category-item" style="border-left: 4px solid ${rankColor}; background: #fffbf0;">
            <div style="margin-bottom: 6px;">
              <span style="font-size: 1.2em; font-weight: 700; color: ${rankColor};">${rankEmoji}</span>
              <span style="font-size: 1em; font-weight: 700; color: #2c3e50; margin-left: 8px;">${rec.facility_type}</span>
              <span style="float: right; background: ${rankColor}; color: white; padding: 3px 10px; border-radius: 15px; font-size: 0.85em; font-weight: 600;">
                ${rec.score.toFixed(1)}ì 
              </span>
            </div>
            <div style="font-size: 0.8em; color: #666;">
              ${rec.description || ''}
            </div>
          </div>
        `;
      });

      html += `
        <div style="margin-top: 15px; text-align: center; padding: 12px; background: #f0f4ff; border-radius: 8px;">
          <span style="color: #667eea; font-weight: 600; cursor: pointer;" onclick="document.getElementById('report-section').scrollIntoView({ behavior: 'smooth' });">
            ğŸ“Š ìƒì„¸ ë¶„ì„ ë³´ê³ ì„œ ë³´ê¸° â†“
          </span>
        </div>
      </div>`;

      return html;
    }

    // ì¹´í…Œê³ ë¦¬ë³„ ì‹œì„¤ ëª©ë¡ ìƒì„±
    function buildFacilitiesList(poiList) {
      if (!poiList || poiList.length === 0) {
        return '';
      }

      // ì¹´í…Œê³ ë¦¬ë³„ë¡œ POI ê·¸ë£¹í™”
      const groupedPois = {
        'HP8': { name: 'ğŸ¥ ë³‘ì›', items: [], color: '#3498db' },
        'SC4': { name: 'ğŸ« í•™êµ', items: [], color: '#2ecc71' },
        'CS2': { name: 'ğŸª í¸ì˜ì ', items: [], color: '#f39c12' },
        'SW8': { name: 'ğŸš‡ ì§€í•˜ì² ì—­', items: [], color: '#9b59b6' },
        'CE7': { name: 'â˜• ì¹´í˜', items: [], color: '#e67e22' }
      };

      poiList.forEach(poi => {
        if (groupedPois[poi.category_group_code]) {
          groupedPois[poi.category_group_code].items.push(poi);
        }
      });

      let html = '<div class="facilities-list"><h3 style="margin-bottom: 15px; color: #2c3e50;">ğŸ“‹ ì‹œì„¤ ìƒì„¸ ëª©ë¡</h3>';

      Object.entries(groupedPois).forEach(([code, category]) => {
        if (category.items.length > 0) {
          // ê±°ë¦¬ìˆœ ì •ë ¬
          category.items.sort((a, b) => (a.distance || 0) - (b.distance || 0));

          html += `
            <div class="facilities-category">
              <div class="facilities-category-header">${category.name} (${category.items.length}ê°œ)</div>
          `;

          category.items.forEach(poi => {
            html += `
              <div class="facility-item" style="border-left-color: ${category.color};" onclick="focusFacility(${poi.y}, ${poi.x}, '${poi.name?.replace(/'/g, "\\'")}', '${category.name}', '${category.color}')">
                <div class="facility-item-name">${poi.name || 'ì´ë¦„ ì—†ìŒ'}</div>
                <div class="facility-item-address">ğŸ“ ${poi.address || 'ì£¼ì†Œ ì •ë³´ ì—†ìŒ'}</div>
                <div class="facility-item-distance">ğŸš¶ ${poi.distance ? poi.distance + 'm' : 'ê±°ë¦¬ ì •ë³´ ì—†ìŒ'}</div>
              </div>
            `;
          });

          html += '</div>';
        }
      });

      html += '</div>';
      return html;
    }

    // ìƒì„¸ ë³´ê³ ì„œ UI (í•˜ë‹¨ ì„¹ì…˜ìš©)
    function buildDetailedReport(report, poiList) {
      if (!report) return '';

      let html = `
        <div style="text-align: center; margin-bottom: 40px;">
          <h2 style="color: #2c3e50; font-size: 2em; margin-bottom: 10px;">
            ğŸ“Š ê³µê³µì‹œì„¤ ì¶”ì²œ ìƒì„¸ ë¶„ì„ ë³´ê³ ì„œ
          </h2>
          <p style="color: #666; font-size: 1.05em;">ì¢…í•©ì ì¸ ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì • ì§€ì› ë¦¬í¬íŠ¸</p>
          <div style="margin-top: 20px; height: 3px; background: linear-gradient(90deg, transparent, #667eea, transparent); border-radius: 2px;"></div>
        </div>

        <!-- 1. ìš”ì•½ -->
        ${buildReportSummary(report.summary)}

        <div class="report-section-divider"></div>

        <!-- 2. ì‹œì„¤ë³„ ìƒì„¸ ë¶„ì„ -->
        ${buildRecommendationDetails(report.detailed_recommendations)}

        <div class="report-section-divider"></div>

        <!-- 3. ì§€ì—­ íŠ¹ì„± ë¶„ì„ -->
        ${buildAreaAnalysis(report.area_analysis)}

        <div class="report-section-divider"></div>

        <!-- 4. ì ìˆ˜ ë¶„í•´ ë¶„ì„ -->
        ${buildScoringBreakdown(report.scoring_breakdown)}

        <div class="report-section-divider"></div>

        <!-- 5. ë¹„êµ ë¶„ì„ -->
        ${buildComparativeAnalysis(report.comparative_analysis)}

        <div class="report-section-divider"></div>

        <!-- 6. ê²°ë¡  ë° ì œì•ˆ -->
        ${buildConclusion(report.conclusion)}

        <div class="report-section-divider"></div>

        <!-- 7. ì‹œì„¤ ìƒì„¸ ëª©ë¡ -->
        ${buildFacilitiesList(poiList)}
      `;

      return html;
    }

    // ìš”ì•½ ì„¹ì…˜
    function buildReportSummary(summary) {
      if (!summary) return '';

      return `
        <div style="margin-bottom: 25px; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; color: white;">
          <h3 style="margin-bottom: 15px; color: white;">ğŸ“ ë¶„ì„ ìš”ì•½</h3>
          <div style="font-size: 0.95em; line-height: 1.8;">
            <strong>ë¶„ì„ ìœ„ì¹˜:</strong> ${summary.location || 'ì •ë³´ ì—†ìŒ'}<br>
            <strong>ë¶„ì„ ì¼ì‹œ:</strong> ${summary.analysis_date || 'ì •ë³´ ì—†ìŒ'}<br>
            <strong>ìµœìš°ì„  ì¶”ì²œ:</strong> ${summary.top_recommendation?.description || 'ì •ë³´ ì—†ìŒ'} (${summary.top_recommendation?.score || 0}ì )<br>
            <strong>ì§€ì—­ íŠ¹ì„±:</strong> ${summary.strongest_characteristic?.indicator || 'ì •ë³´ ì—†ìŒ'} ${summary.strongest_characteristic?.score || 0}ì 
          </div>
        </div>
      `;
    }

    // ì‹œì„¤ë³„ ìƒì„¸ ë¶„ì„
    function buildRecommendationDetails(details) {
      if (!details || details.length === 0) return '';

      let html = `
        <div style="margin-bottom: 25px;">
          <h3 style="margin-bottom: 15px; color: #2c3e50; border-left: 4px solid #667eea; padding-left: 10px;">
            ğŸ—ï¸ ì‹œì„¤ë³„ ìƒì„¸ ë¶„ì„
          </h3>
      `;

      details.forEach((rec, index) => {
        const rankEmoji = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : `${rec.rank}ìœ„`;
        const gradeColor = rec.grade === 'S' || rec.grade === 'A+' ? '#2ecc71' :
                          rec.grade === 'A' || rec.grade === 'B+' ? '#f39c12' : '#e74c3c';

        html += `
          <div style="margin-bottom: 20px; padding: 18px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid ${gradeColor};">
            <div style="margin-bottom: 12px;">
              <span style="font-size: 1.2em;">${rankEmoji}</span>
              <span style="font-size: 1.15em; font-weight: 700; color: #2c3e50; margin-left: 8px;">${rec.description}</span>
              <span style="float: right; background: ${gradeColor}; color: white; padding: 5px 15px; border-radius: 20px; font-weight: 600;">
                ${rec.overall_score}ì  (${rec.grade})
              </span>
            </div>

            <!-- ì ìˆ˜ ê³„ì‚° ê³¼ì • -->
            ${buildScoringDetail(rec.scoring_detail)}

            <!-- ì…ì§€ ë¶„ì„ -->
            ${buildLocationAnalysis(rec.location_analysis)}

            <!-- ì‹¤í–‰ ê°€ëŠ¥ì„± -->
            ${buildFeasibility(rec.feasibility)}
          </div>
        `;
      });

      html += '</div>';
      return html;
    }

    // ì ìˆ˜ ê³„ì‚° ìƒì„¸
    function buildScoringDetail(scoring) {
      if (!scoring) return '';

      let html = `
        <div style="margin-top: 12px; padding: 12px; background: white; border-radius: 8px;">
          <div style="font-weight: 600; margin-bottom: 8px; color: #555;">ğŸ“Š ì ìˆ˜ ê³„ì‚° ê³¼ì •</div>
          <div style="font-size: 0.9em; color: #666; line-height: 1.6;">
            â€¢ ê¸°ë³¸ ì ìˆ˜: ${scoring.base_score}ì <br>
      `;

      if (scoring.indicator_contributions && scoring.indicator_contributions.length > 0) {
        html += '<div style="margin-top: 8px; margin-left: 10px;">';
        scoring.indicator_contributions.forEach(contrib => {
          html += `
            <div style="margin-bottom: 4px;">
              â–¸ ${contrib.indicator}: ${contrib.raw_score}ì  Ã— ${contrib.weight} = ${contrib.contribution}ì  (${contrib.percentage}%)
            </div>
          `;
        });
        html += '</div>';
      }

      if (scoring.penalties && scoring.penalties.details && scoring.penalties.details.length > 0) {
        html += '<div style="margin-top: 8px; color: #e74c3c;">â€¢ ê°ì  ìš”ì¸:</div>';
        html += '<div style="margin-left: 10px; color: #e74c3c;">';
        scoring.penalties.details.forEach(penalty => {
          html += `
            <div style="margin-bottom: 4px;">
              â–¸ ${penalty.type}: ${penalty.reason} (-${penalty.penalty_percentage}%, ì˜í–¥ë„: ${penalty.impact})
            </div>
          `;
        });
        html += `<div style="margin-top: 4px; font-weight: 600;">ì´ ê°ì : -${scoring.penalties.total_penalty_percentage}%</div>`;
        html += '</div>';
      }

      html += `
            â€¢ <strong>ìµœì¢… ì ìˆ˜: ${scoring.final_score}ì </strong>
          </div>
        </div>
      `;

      return html;
    }

    // ì…ì§€ ë¶„ì„
    function buildLocationAnalysis(analysis) {
      if (!analysis) return '';

      return `
        <div style="margin-top: 12px; padding: 12px; background: white; border-radius: 8px;">
          <div style="font-weight: 600; margin-bottom: 8px; color: #555;">ğŸ“ ì…ì§€ ì í•©ì„± ë¶„ì„</div>
          <div style="font-size: 0.9em; color: #666; line-height: 1.6;">
            <div style="margin-bottom: 8px;"><strong>ì¢…í•© í‰ê°€:</strong> ${analysis.overall_suitability}</div>
            ${analysis.strengths && analysis.strengths.length > 0 ? `
              <div style="color: #2ecc71; margin-bottom: 6px;">
                <strong>âœ“ ê°•ì :</strong><br>
                ${analysis.strengths.map(s => `  â€¢ ${s}`).join('<br>')}
              </div>
            ` : ''}
            ${analysis.weaknesses && analysis.weaknesses.length > 0 ? `
              <div style="color: #e74c3c; margin-bottom: 6px;">
                <strong>âœ— ì•½ì :</strong><br>
                ${analysis.weaknesses.map(w => `  â€¢ ${w}`).join('<br>')}
              </div>
            ` : ''}
            ${analysis.competition && analysis.competition.length > 0 ? `
              <div style="color: #f39c12;">
                <strong>âš  ê²½ìŸ ì‹œì„¤:</strong> ${analysis.competition.join(', ')}
              </div>
            ` : ''}
          </div>
        </div>
      `;
    }

    // ì‹¤í–‰ ê°€ëŠ¥ì„±
    function buildFeasibility(feasibility) {
      if (!feasibility) return '';

      const levelColor = feasibility.level === 'ë†’ìŒ' ? '#2ecc71' :
                        feasibility.level === 'ì¤‘ê°„' ? '#f39c12' : '#e74c3c';

      return `
        <div style="margin-top: 12px; padding: 12px; background: white; border-radius: 8px;">
          <div style="font-weight: 600; margin-bottom: 8px; color: #555;">ğŸ¯ ì‹¤í–‰ ê°€ëŠ¥ì„±</div>
          <div style="font-size: 0.9em; color: #666; line-height: 1.6;">
            â€¢ <strong>ê°€ëŠ¥ì„± ìˆ˜ì¤€:</strong> <span style="color: ${levelColor}; font-weight: 600;">${feasibility.level}</span> (${feasibility.score}ì )<br>
            â€¢ <strong>ê¸°ì¡´ ì‹œì„¤ ì˜í–¥:</strong> ${feasibility.existing_facilities_impact}<br>
            â€¢ <strong>ê¶Œì¥ì‚¬í•­:</strong> ${feasibility.recommendation}
          </div>
        </div>
      `;
    }

    // ì§€ì—­ íŠ¹ì„± ë¶„ì„
    function buildAreaAnalysis(analysis) {
      if (!analysis) return '';

      return `
        <div style="margin-bottom: 25px; padding: 18px; background: #f0f4ff; border-radius: 10px;">
          <h3 style="margin-bottom: 15px; color: #2c3e50; border-left: 4px solid #667eea; padding-left: 10px;">
            ğŸŒ ì§€ì—­ íŠ¹ì„± ì¢…í•© ë¶„ì„
          </h3>
          <div style="font-size: 0.95em; line-height: 1.8; color: #555;">
            <strong>ì§€ì—­ ìœ í˜•:</strong> ${analysis.location_type || 'ì •ë³´ ì—†ìŒ'}<br>
            <strong>ê°œë°œ ì ì¬ë ¥:</strong> ${analysis.development_potential?.level || 'ì •ë³´ ì—†ìŒ'} (${analysis.development_potential?.score || 0}ì )
            <div style="margin-top: 5px; font-size: 0.9em; color: #666;">
              ${analysis.development_potential?.reasoning || ''}
            </div>
          </div>

          ${analysis.poi_distribution ? `
            <div style="margin-top: 15px; padding: 12px; background: white; border-radius: 8px;">
              <div style="font-weight: 600; margin-bottom: 8px;">ğŸ“ POI ë¶„í¬</div>
              <div style="font-size: 0.9em; color: #666;">
                ì´ ${analysis.poi_distribution.total_count}ê°œ (ë°€ì§‘ë„: ${analysis.poi_distribution.density})
              </div>
            </div>
          ` : ''}

          ${analysis.existing_facilities_status && analysis.existing_facilities_status.total_count ? `
            <div style="margin-top: 15px; padding: 12px; background: white; border-radius: 8px;">
              <div style="font-weight: 600; margin-bottom: 8px;">ğŸ—ï¸ ê¸°ì¡´ ì‹œì„¤ í˜„í™©</div>
              <div style="font-size: 0.9em; color: #666;">
                ì´ ${analysis.existing_facilities_status.total_count}ê°œ ì‹œì„¤
                (í¬í™”ë„: ${analysis.existing_facilities_status.saturation_level})
              </div>
            </div>
          ` : ''}
        </div>
      `;
    }

    // ì ìˆ˜ ë¶„í•´ ë¶„ì„
    function buildScoringBreakdown(breakdown) {
      if (!breakdown) return '';

      return `
        <div style="margin-bottom: 25px; padding: 18px; background: #fff8f0; border-radius: 10px;">
          <h3 style="margin-bottom: 15px; color: #2c3e50; border-left: 4px solid #f39c12; padding-left: 10px;">
            ğŸ“ˆ ì ìˆ˜ ë¶„í¬ ë¶„ì„
          </h3>

          ${breakdown.top_3_comparison ? `
            <div style="margin-bottom: 15px;">
              <div style="font-weight: 600; margin-bottom: 8px; color: #555;">ìƒìœ„ 3ê°œ ì‹œì„¤ ë¹„êµ</div>
              ${breakdown.top_3_comparison.map((item, idx) => `
                <div style="margin-bottom: 6px; font-size: 0.9em; color: #666;">
                  ${idx + 1}ìœ„. ${item.facility_type}: ${item.score}ì 
                  ${item.score_difference_from_top > 0 ? `(-${item.score_difference_from_top}ì )` : ''}
                </div>
              `).join('')}
            </div>
          ` : ''}

          ${breakdown.score_distribution ? `
            <div style="padding: 12px; background: white; border-radius: 8px;">
              <div style="font-weight: 600; margin-bottom: 8px; color: #555;">ì ìˆ˜ ë¶„í¬</div>
              <div style="font-size: 0.9em; color: #666;">
                â€¢ ìš°ìˆ˜ (80ì  ì´ìƒ): ${breakdown.score_distribution.excellent}ê°œ<br>
                â€¢ ì–‘í˜¸ (60-79ì ): ${breakdown.score_distribution.good}ê°œ<br>
                â€¢ ë³´í†µ (40-59ì ): ${breakdown.score_distribution.fair}ê°œ<br>
                â€¢ ë¯¸í¡ (40ì  ë¯¸ë§Œ): ${breakdown.score_distribution.poor}ê°œ
              </div>
            </div>
          ` : ''}
        </div>
      `;
    }

    // ë¹„êµ ë¶„ì„
    function buildComparativeAnalysis(analysis) {
      if (!analysis) return '';

      return `
        <div style="margin-bottom: 25px; padding: 18px; background: #f0fff4; border-radius: 10px;">
          <h3 style="margin-bottom: 15px; color: #2c3e50; border-left: 4px solid #2ecc71; padding-left: 10px;">
            âš–ï¸ ë¹„êµ ë¶„ì„
          </h3>

          ${analysis.top_vs_bottom ? `
            <div style="margin-bottom: 15px; padding: 12px; background: white; border-radius: 8px;">
              <div style="font-weight: 600; margin-bottom: 8px; color: #555;">1ìœ„ vs ìµœí•˜ìœ„</div>
              <div style="font-size: 0.9em; color: #666; line-height: 1.6;">
                â€¢ 1ìœ„: ${analysis.top_vs_bottom.top_facility?.type} (${analysis.top_vs_bottom.top_facility?.score}ì )<br>
                â€¢ ìµœí•˜ìœ„: ${analysis.top_vs_bottom.bottom_facility?.type} (${analysis.top_vs_bottom.bottom_facility?.score}ì )<br>
                â€¢ ì ìˆ˜ ê²©ì°¨: ${analysis.top_vs_bottom.score_gap}ì <br>
                â€¢ <strong>${analysis.top_vs_bottom.interpretation}</strong>
              </div>
            </div>
          ` : ''}

          ${analysis.competitiveness ? `
            <div style="padding: 12px; background: white; border-radius: 8px;">
              <div style="font-weight: 600; margin-bottom: 8px; color: #555;">ê²½ìŸë„ ë¶„ì„</div>
              <div style="font-size: 0.9em; color: #666;">
                í‰ê·  ì ìˆ˜: ${analysis.competitiveness.average_score}ì 
                (${analysis.competitiveness.competitiveness})
              </div>
            </div>
          ` : ''}
        </div>
      `;
    }

    // ê²°ë¡  ë° ì œì•ˆ
    function buildConclusion(conclusion) {
      if (!conclusion) return '';

      return `
        <div style="padding: 20px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 10px; color: white;">
          <h3 style="margin-bottom: 15px; color: white;">ğŸ’¡ ê²°ë¡  ë° ì œì•ˆ</h3>

          <div style="margin-bottom: 15px; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 8px;">
            <div style="font-weight: 600; margin-bottom: 8px;">ğŸ¯ ìµœìš°ì„  ì¶”ì²œ</div>
            <div style="font-size: 0.95em; line-height: 1.6;">
              <strong>${conclusion.primary_recommendation?.facility}</strong><br>
              ${conclusion.primary_recommendation?.reason}
            </div>
          </div>

          ${conclusion.alternative_options && conclusion.alternative_options.length > 0 ? `
            <div style="margin-bottom: 15px; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 8px;">
              <div style="font-weight: 600; margin-bottom: 8px;">ğŸ”„ ëŒ€ì•ˆ ì˜µì…˜</div>
              ${conclusion.alternative_options.map((opt, idx) => `
                <div style="font-size: 0.9em; margin-bottom: 6px;">
                  ${idx + 2}ìˆœìœ„. ${opt.facility}<br>
                  <span style="font-size: 0.85em; opacity: 0.9;">${opt.reason}</span>
                </div>
              `).join('')}
            </div>
          ` : ''}

          ${conclusion.key_considerations && conclusion.key_considerations.length > 0 ? `
            <div style="margin-bottom: 15px; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 8px;">
              <div style="font-weight: 600; margin-bottom: 8px;">âš ï¸ ì£¼ìš” ê³ ë ¤ì‚¬í•­</div>
              ${conclusion.key_considerations.map(item => `
                <div style="font-size: 0.9em; margin-bottom: 4px;">â€¢ ${item}</div>
              `).join('')}
            </div>
          ` : ''}

          ${conclusion.next_steps && conclusion.next_steps.length > 0 ? `
            <div style="padding: 15px; background: rgba(255,255,255,0.2); border-radius: 8px;">
              <div style="font-weight: 600; margin-bottom: 8px;">ğŸ“‹ ë‹¤ìŒ ë‹¨ê³„</div>
              ${conclusion.next_steps.map((step, idx) => `
                <div style="font-size: 0.9em; margin-bottom: 4px;">${idx + 1}. ${step}</div>
              `).join('')}
            </div>
          ` : ''}
        </div>
      `;
    }

    // ì‹œì„¤ í´ë¦­ ì‹œ ì§€ë„ì—ì„œ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™
    function focusFacility(lat, lng, name, category, color) {
      const position = new kakao.maps.LatLng(lat, lng);
      map.setCenter(position);
      map.setLevel(3);

      // ì¸í¬ìœˆë„ìš° í‘œì‹œ
      if (infowindow) {
        infowindow.close();
      }

      const infoContent = `
        <div style="padding: 10px; min-width: 200px;">
          <div style="font-weight: 600; margin-bottom: 5px; color: #2c3e50;">
            ${name}
          </div>
          <div style="font-size: 0.85em; color: ${color}; font-weight: 500;">
            ${category}
          </div>
        </div>
      `;

      infowindow = new kakao.maps.InfoWindow({
        content: infoContent,
        removable: true
      });

      infowindow.open(map, new kakao.maps.Marker({
        position: position
      }));
    }

    // ì§€ë„ì— ë§ˆì»¤ í‘œì‹œ
    function displayOnMap(data) {
      if (!data.coordinates) return;

      const position = new kakao.maps.LatLng(data.coordinates.lat, data.coordinates.lng);

      // ì§€ë„ ì¤‘ì‹¬ ì´ë™
      map.setCenter(position);
      map.setLevel(4);

      // ê²€ìƒ‰ ë°˜ê²½ ì› í‘œì‹œ (1km)
      if (searchCircle) {
        searchCircle.setMap(null);
      }

      searchCircle = new kakao.maps.Circle({
        center: position,
        radius: 1000, // ë¯¸í„° ë‹¨ìœ„ (1km)
        strokeWeight: 2,
        strokeColor: '#667eea',
        strokeOpacity: 0.8,
        strokeStyle: 'solid',
        fillColor: '#667eea',
        fillOpacity: 0.1
      });

      searchCircle.setMap(map);

      // ê²€ìƒ‰ ìœ„ì¹˜ ë§ˆì»¤ (ë¹¨ê°•)
      const mainMarker = new kakao.maps.Marker({
        map: map,
        position: position,
        title: data.address
      });

      // ë§ˆì»¤ ìƒ‰ìƒ ë³€ê²½ (ë¹¨ê°•)
      const mainContent = `<div style="background: #e74c3c; width: 12px; height: 12px; border-radius: 50%; border: 3px solid white; box-shadow: 0 0 5px rgba(0,0,0,0.3);"></div>`;
      const mainCustomOverlay = new kakao.maps.CustomOverlay({
        position: position,
        content: mainContent
      });
      mainCustomOverlay.setMap(map);

      markers.push(mainMarker);

      // POI ë§ˆì»¤ ì¶”ê°€
      if (data.poi_list) {
        data.poi_list.forEach(poi => {
          if (poi.x && poi.y) {
            const poiPosition = new kakao.maps.LatLng(poi.y, poi.x);
            const color = categoryColors[poi.category_group_code] || '#95a5a6';

            // ì»¤ìŠ¤í…€ ì˜¤ë²„ë ˆì´ìš© DOM ìš”ì†Œ ìƒì„±
            const markerDiv = document.createElement('div');
            markerDiv.style.cssText = `background: ${color}; width: 8px; height: 8px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 3px rgba(0,0,0,0.3); cursor: pointer;`;

            const customOverlay = new kakao.maps.CustomOverlay({
              position: poiPosition,
              content: markerDiv,
              clickable: true
            });
            customOverlay.setMap(map);

            // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
            markerDiv.addEventListener('click', function() {
              // ê¸°ì¡´ ì¸í¬ìœˆë„ìš°ê°€ ìˆìœ¼ë©´ ë‹«ê¸°
              if (infowindow) {
                infowindow.close();
              }

              // ìƒˆ ì¸í¬ìœˆë„ìš° ìƒì„±
              const categoryName = categoryNames[poi.category_group_code] || 'ê¸°íƒ€';
              const infoContent = `
                <div style="padding: 10px; min-width: 200px;">
                  <div style="font-weight: 600; margin-bottom: 5px; color: #2c3e50;">
                    ${poi.name || 'ì´ë¦„ ì—†ìŒ'}
                  </div>
                  <div style="font-size: 0.85em; color: #666; margin-bottom: 3px;">
                    ğŸ“ ${poi.address || 'ì£¼ì†Œ ì •ë³´ ì—†ìŒ'}
                  </div>
                  <div style="font-size: 0.85em; color: ${color}; font-weight: 500;">
                    ${categoryName}
                  </div>
                </div>
              `;

              infowindow = new kakao.maps.InfoWindow({
                content: infoContent,
                removable: true
              });

              infowindow.open(map, new kakao.maps.Marker({
                position: poiPosition
              }));

              // ì˜¤ë¥¸ìª½ íŒ¨ë„ì— ì‹œì„¤ ì •ë³´ í‘œì‹œ
              displayFacilityInfo(poi, categoryName, color);
            });
          }
        });
      }
    }

    // ì‹œì„¤ ì •ë³´ í‘œì‹œ
    function displayFacilityInfo(poi, categoryName, color) {
      // ê¸°ì¡´ ì‹œì„¤ ì •ë³´ ì œê±°
      const existingInfo = document.getElementById('facility-info-section');
      if (existingInfo) {
        existingInfo.remove();
      }

      // ìƒˆ ì‹œì„¤ ì •ë³´ ì¶”ê°€
      const resultsDiv = document.getElementById('results-summary');
      const facilityInfoHtml = `
        <div id="facility-info-section" class="facility-info">
          <div class="facility-info-title">ğŸ“ ì„ íƒëœ ì‹œì„¤</div>
          <div class="facility-info-detail">
            <strong>ìƒí˜¸ëª…:</strong> ${poi.name || 'ì´ë¦„ ì—†ìŒ'}
          </div>
          <div class="facility-info-detail">
            <strong>ì£¼ì†Œ:</strong> ${poi.address || 'ì£¼ì†Œ ì •ë³´ ì—†ìŒ'}
          </div>
          <div class="facility-info-detail">
            <strong>ë¶„ë¥˜:</strong> <span style="color: ${color}; font-weight: 600;">${categoryName}</span>
          </div>
          <div class="facility-info-detail">
            <strong>ê±°ë¦¬:</strong> ${poi.distance ? poi.distance + 'm' : 'ì •ë³´ ì—†ìŒ'}
          </div>
        </div>
      `;

      resultsDiv.insertAdjacentHTML('beforeend', facilityInfoHtml);

      // ìŠ¤í¬ë¡¤ì„ í•˜ë‹¨ìœ¼ë¡œ ì´ë™
      resultsDiv.scrollTop = resultsDiv.scrollHeight;
    }

    // ë§ˆì»¤ ì§€ìš°ê¸°
    function clearMarkers() {
      markers.forEach(marker => marker.setMap(null));
      markers = [];

      // ê²€ìƒ‰ ë°˜ê²½ ì›ë„ ì œê±°
      if (searchCircle) {
        searchCircle.setMap(null);
        searchCircle = null;
      }

      // ì‹œì„¤ ì •ë³´ë„ ì œê±°
      const existingInfo = document.getElementById('facility-info-section');
      if (existingInfo) {
        existingInfo.remove();
      }
    }

    // ì—”í„°í‚¤ ì´ë²¤íŠ¸
    document.getElementById('address').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        searchAddress();
      }
    });

    // ì¹´ì¹´ì˜¤ë§µ ì´ˆê¸°í™” í•¨ìˆ˜
    function initKakaoMap() {
      console.log('ğŸ”§ Initializing Kakao Maps...');
      const container = document.getElementById('map');
      const options = {
        center: new kakao.maps.LatLng(37.5665, 126.9780),
        level: 5
      };

      map = new kakao.maps.Map(container, options);
      geocoder = new kakao.maps.services.Geocoder();
      console.log('âœ… Kakao Maps initialized successfully');
    }
  </script>

  <!-- Kakao Maps SDK - ë§ˆì§€ë§‰ì— ë¡œë“œí•˜ê³  ì½œë°±ìœ¼ë¡œ ì´ˆê¸°í™” -->
  <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=<%= @kakao_api_key %>&libraries=services&autoload=false" onload="kakao.maps.load(initKakaoMap)"></script>
</body>
</html>
